(this.webpackJsonpbus_information_site=this.webpackJsonpbus_information_site||[]).push([[0],{11:function(e){e.exports=JSON.parse('{"station_key":"N%2BQFA%2BwFDx9oMiWdwzjq248QR9Ka1w70Onnmpvdhc1%2FOmwDoLEWlXABOOrTr42J%2F03YjttaCrnwTA4hiJH1OiA%3D%3D","vworld_key":"B68996E4-BC0C-3C4A-B658-93658DD96E73"}')},16:function(e,t,n){},32:function(e,t,n){},54:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n(13),o=n.n(s),r=(n(32),n(2)),a=(n(16),n(65)),i=n(66),l=n(67),u=n(69),d=n(68),j=(n(33),n(6)),b=n.n(j),m=n(11),f=n(25),v=n.n(f),p=function(e){return v.a.get("".concat("/api").concat(e)).then((function(e){return e})).catch((function(e){return e}))},O=n(0),h=m.station_key,x=function(e,t,n){return!(e.gpslati<t.lat||e.gpslati>n.lat||e.gpslong<t.lng||e.gpslong>n.lng)},g=function(e){var t=e.position,n=e.apiState,s=e.setPosition,o=e.setApiState,r=e.setStation,i=e.setZoomLevel,l=e.setZoomState,u=Object(a.a)();Object(c.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){s([e.coords.latitude,e.coords.longitude])}))}),[]),Object(c.useEffect)((function(){u.setView(t,u.getZoom())}),[t]);var d=function(e){e>=17&&n&&function(e,t,n,c,s){var o=n.lat,r=n.lng,a="?serviceKey=".concat(h,"&gpsLati=").concat(o,"&gpsLong=").concat(r),i="/BusSttnInfoInqireService/getCrdntPrxmtSttnList".concat(a);t&&p(i).then((function(t){var n=t.data.response.header,o=t.data.response.body;if("00"===n.resultCode||0===n.resultCode){var r=o.items.item,a=[];null==r||void 0===r?a=[]:Array.isArray(r)?r.forEach((function(e){x(e,c,s)&&!e.nodeid.includes("GHB")&&a.push(e)})):a=x(r,c,s)?[]:[r],e(a)}else console.log(o)})).catch((function(e){console.log(e)}))}(r,n,u.getCenter(),u.getBounds().getSouthWest(),u.getBounds().getNorthEast())},j=Object(a.b)({zoomstart:function(){o(!1),l(!1)},zoomend:function(){i(j.getZoom()),o(!0),l(!0)},moveend:function(){d(j.getZoom())},dragend:function(){o(!0),l(!0)}});return Object(O.jsx)(O.Fragment,{})},S=function(e){var t=e.selectID,n=e.nodeid,c=e.nodenm;return Object(O.jsx)(i.a,{direction:"top",opacity:1,permanent:!0,interactive:!0,children:Object(O.jsxs)("div",{className:t===n?"select":"",children:[Object(O.jsx)("div",{children:Object(O.jsx)("img",{alt:"",className:"busIcon",src:""+t===n?"/marker.png":"/marker_white.png"})}),Object(O.jsxs)("div",{children:[Object(O.jsx)("span",{children:c}),Object(O.jsx)("span",{children:n})]})]})})},N=function(e){var t=e.position,n=e.zoomLevel,s=e.station,o=e.selectID,a=e.apiState,i=e.setPosition,j=e.setZoomLevel,f=e.setStation,v=e.setSelectID,p=e.settingBusStop,h=e.setApiState,x="https://api.vworld.kr/req/wmts/1.0.0/".concat(m.vworld_key,"/Base/{z}/{y}/{x}.png"),N=Object(c.useState)(!0),y=Object(r.a)(N,2),I=y[0],C=y[1],k=b.a.icon({iconUrl:"/marker.png",iconRetinaUrl:"/marker.png",iconAnchor:[15,15],popupAnchor:[0,0],iconSize:[30,30]});return Object(O.jsxs)("div",{className:"map-container",children:[n<15?Object(O.jsx)("div",{className:"alert-box",children:Object(O.jsx)("h5",{children:"\uc870\uae08 \ub354 \uac00\uae4c\uc774 \uc774\ub3d9\ud574\uc8fc\uc138\uc694"})}):Object(O.jsx)("div",{}),Object(O.jsxs)(l.a,{center:t,zoom:n,scrollWheelZoom:!0,children:[Object(O.jsx)(u.a,{maxZoom:22,maxNativeZoom:18,attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:x}),Object(O.jsx)(g,{apiState:a,setApiState:h,position:t,setPosition:i,setZoomLevel:j,setStation:f,setZoomState:C}),I&&n>=15&&s.length>0&&s.map((function(e,t){var n=e.citycode,c=e.gpslati,s=e.gpslong,r=e.nodeid,a=e.nodenm;return Object(O.jsx)(d.a,{position:[c.toString(),s.toString()],icon:k,eventHandlers:{click:function(){return function(e,t,n,c,s){v(s),p(e,t,n,s,c)}(n,c,s,a,r)}},children:Object(O.jsx)(S,{nodenm:a,nodeid:r,selectID:o})},t)}))]})]})},y=n(5),I=n.n(y),C=n(10),k=n(26),w=n.n(k),B=(n(54),function(e){return Object(O.jsx)("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"512.000000pt",height:"512.000000pt",viewBox:"0 0 512.000000 512.000000",preserveAspectRatio:"xMidYMid meet",children:Object(O.jsx)("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:e.fill,stroke:"none",children:Object(O.jsx)("path",{d:"M838 5104 c-169 -40 -318 -174 -381 -341 -21 -57 -22 -71 -27 -602 l-5 -544 -41 -12 c-117 -35 -253 -142 -312 -248 -60 -106 -67 -143 -67 -357 0 -189 1 -197 26 -251 57 -121 154 -180 307 -187 l92 -4 0 -837 c0 -921 -2 -894 62 -1013 60 -113 194 -223 316 -259 l42 -12 0 -57 c0 -170 69 -296 194 -352 50 -22 59 -23 341 -23 l290 0 56 26 c121 57 180 154 187 307 l4 92 638 0 638 0 4 -93 c7 -152 66 -249 187 -306 l56 -26 290 0 c282 0 291 1 341 23 125 56 194 182 194 352 l0 57 43 12 c121 36 255 146 315 259 64 119 62 92 62 1013 l0 837 93 4 c152 7 249 66 306 187 25 54 26 62 26 251 0 214 -7 251 -67 357 -59 106 -195 213 -312 248 l-41 12 -5 544 c-5 531 -6 545 -27 602 -64 169 -213 301 -385 342 -91 21 -3352 21 -3440 -1z m3032 -443 c61 -32 117 -86 148 -146 23 -43 27 -62 27 -140 0 -106 -20 -158 -88 -225 -51 -52 -96 -75 -172 -89 -82 -15 -2368 -15 -2450 0 -76 14 -121 37 -172 89 -68 67 -88 119 -88 225 0 75 4 98 24 135 42 81 117 145 201 171 14 4 588 7 1275 6 l1250 -2 45 -24z m206 -849 c58 -27 123 -89 153 -148 39 -76 42 -131 39 -717 l-3 -562 -33 -67 c-37 -76 -82 -120 -162 -157 l-55 -26 -1455 0 -1455 0 -67 33 c-76 37 -120 82 -157 162 l-26 55 -3 562 c-3 586 0 642 39 717 25 50 83 112 124 134 80 42 44 41 1560 39 l1450 -2 51 -23z m-2561 -2137 c135 -59 210 -200 183 -345 -13 -71 -37 -116 -88 -167 -67 -68 -119 -88 -225 -88 -75 0 -98 4 -135 24 -61 32 -116 86 -148 146 -23 43 -27 62 -27 140 0 106 20 158 88 225 50 51 86 70 157 86 69 15 130 8 195 -21z m2270 24 c76 -14 121 -37 172 -89 68 -67 88 -119 88 -225 0 -78 -4 -97 -27 -140 -32 -60 -87 -114 -148 -146 -65 -34 -204 -34 -272 -1 -55 27 -122 91 -148 142 -96 188 22 425 229 460 25 4 46 8 47 9 0 0 27 -4 59 -10z"})})})}),A=m.station_key,L=function(e){var t=e.mapMode,n=e.station,s=e.selectBusStop,o=e.settingBusStop,a=e.setMapMode,i=Object(c.useState)([]),l=Object(r.a)(i,2),u=l[0],d=l[1],j=Object(c.useState)(null),b=Object(r.a)(j,2),m=b[0],f=b[1],v=Object(c.useState)(!1),h=Object(r.a)(v,2),x=h[0],g=h[1],S=Object(c.useState)(null),N=Object(r.a)(S,2),y=N[0],k=N[1],L=Object(c.useState)(null),D=Object(r.a)(L,2),z=D[0],F=D[1],M=function(e){var t="#146ACC";switch(e){case"\uac04\uc120\ubc84\uc2a4":t="#008039";break;case"\uc88c\uc11d\ubc84\uc2a4":case"\uae09\ud589\ubc84\uc2a4":case"\uad11\uc5ed\ubc84\uc2a4":t="#CC1100"}return t},E=function(){var e=new Date;f("".concat(e.getHours().toString().padStart(2,"0"),":").concat(e.getMinutes().toString().padStart(2,"0")))},Z=function(){var e=Object(C.a)(I.a.mark((function e(){var t,n,c,o,r,a,i,l,u;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),t="?serviceKey=".concat(A,"&cityCode=").concat(s.citycode,"&nodeId=").concat(s.nodeid),n="/ArvlInfoInqireService/getSttnAcctoArvlPrearngeInfoList".concat(t),e.next=5,p(n);case 5:if(c=e.sent,o=c.data.response.header,r=c.data.response.body,"00"!==o.resultCode&&0!==o.resultCode){e.next=39;break}if(a=r.items,i=[],null==a.item){e.next=33;break}if(0===(a=a.item).length||!Array.isArray(a)){e.next=19;break}return e.next=16,Promise.all(a.map(function(){var e=Object(C.a)(I.a.mark((function e(t){var n,c,s,o,r,a;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.routeno,c=t.routeid,s=t.arrtime,o=t.arrprevstationcnt,(r={}).routeid=c,r.routeno=n,r.arrtime=s,r.arrprevstationcnt=o,e.next=8,R(c);case 8:return a=e.sent,r.routeInfo=a,e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 16:i=e.sent,e.next=33;break;case 19:if("object"!==typeof a){e.next=32;break}return(l={}).routeid=a.routeid,l.routeno=a.routeno,l.arrtime=a.arrtime,l.arrprevstationcnt=a.arrprevstationcnt,e.next=27,R(a.routeid);case 27:u=e.sent,l.routeInfo=u,i.push(l),e.next=33;break;case 32:console.log(a);case 33:i.sort((function(e,t){return e.arrtime-t.arrtime})),d(i),E(),g(!1),e.next=40;break;case 39:console.log(r.header.resultCode);case 40:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(C.a)(I.a.mark((function e(t){var n,c,o,r,a,i;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="?serviceKey=".concat(A,"&cityCode=").concat(s.citycode,"&routeId=").concat(t),c="/BusLcInfoInqireService/getRouteAcctoBusLcList".concat(n),e.next=4,p(c);case 4:o=e.sent,r=o.data.response.header,a=o.data.response.body,"00"!==r.resultCode&&0!==r.resultCode||(i=a.items.item,E(),F(i));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(C.a)(I.a.mark((function e(t){var n,c,o,r,a,i;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="?serviceKey=".concat(A,"&cityCode=").concat(s.citycode,"&routeId=").concat(t),c="/BusRouteInfoInqireService/getRouteInfoIem".concat(n),e.next=4,p(c);case 4:if(o=e.sent,r=o.data.response.header,a=o.data.response.body,"00"!==r.resultCode&&0!==r.resultCode){e.next=10;break}return i=a.items.item,e.abrupt("return",i);case 10:return e.abrupt("return",r.resultCode);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(C.a)(I.a.mark((function e(t){var n,c,o,r,i,l;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="?serviceKey=".concat(A,"&cityCode=").concat(null===s||void 0===s?void 0:s.citycode,"&routeId=").concat(t.routeid,"&numOfRows=500"),c="/BusRouteInfoInqireService/getRouteAcctoThrghSttnList".concat(n),e.next=4,p(c);case 4:o=e.sent,r=o.data.response.header,i=o.data.response.body,"00"!==r.resultCode&&0!==r.resultCode||(l=i.items.item,t.routeInfo.busStopList=l,k(t),a(2));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){console.log("arravalInRoute",z)}),[z]),Object(c.useEffect)((function(){0===t&&u.length>0&&d([])}),[t]),Object(c.useEffect)((function(){null!==s&&1===t&&Z()}),[s,t]);var q=function(e){var t="number"===typeof e?e.toString():e;return t="".concat(t.substr(0,2),":").concat(t.substr(2))};return Object(O.jsx)("div",{className:"information-container",children:function(){switch(t){case 0:return Object(O.jsx)("div",{className:"information-table",children:Object(O.jsx)("div",{className:"bus-stop-list",children:n.length>0&&n.map((function(e,t){var n=e.citycode,c=e.gpslati,s=e.gpslong,r=e.nodenm,a=e.nodeid;return Object(O.jsx)("div",{onClick:function(){return o(n,c,s,a,r)},children:Object(O.jsxs)("div",{className:"info",children:[Object(O.jsx)("img",{src:"/marker.png",alt:""}),Object(O.jsxs)("h5",{children:[r,"(",a,")"]})]})},t)}))})});case 1:return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"bus-stop-contaienr",children:[Object(O.jsx)("div",{className:"bus-stop-name",children:s.nodenm}),Object(O.jsx)("div",{className:"bus-stop-information",children:Object(O.jsxs)("div",{className:"refresh-time",children:[m," \uae30\uc900",Object(O.jsx)("button",{onClick:function(){return Z()},children:Object(O.jsx)("i",{className:"fas fa-sync-alt"})})]})})]}),x?Object(O.jsxs)("div",{className:"loading",children:[Object(O.jsx)(w.a,{})," "]}):Object(O.jsx)("div",{className:"bus-arraval-list",children:u.length>0?u.map((function(e,t){return function(e,t){var n=Math.floor(e.arrtime/60),c=M(e.routeInfo.routetp);return Object(O.jsxs)("div",{onClick:function(){_(e),P(e.routeid)},children:[Object(O.jsx)(B,{fill:c}),Object(O.jsxs)("div",{className:"info-div",children:[Object(O.jsxs)("div",{className:"route-info",children:[Object(O.jsx)("div",{className:"route-number",children:e.routeno}),"number"!==typeof e.routeInfo&&Object(O.jsx)("div",{className:"route-start-end",children:"".concat(e.routeInfo.startnodenm,"\u2194").concat(e.routeInfo.endnodenm)})]}),Object(O.jsxs)("div",{className:"arraval-info",children:[Object(O.jsx)("span",{children:n<3?"\uc7a0\uc2dc \ud6c4 \ub3c4\ucc29":"".concat(n,"\ubd84")}),Object(O.jsxs)("span",{children:[e.arrprevstationcnt,"\uc815\ub958\uc7a5"]})]})]})]},t)}(e,t)})):Object(O.jsx)("span",{children:"\ub3c4\ucc29 \uc608\uc815 \uc815\ubcf4 \uc5c6\uc74c"})})]});case 2:var e,c=q(null===y||void 0===y?void 0:y.routeInfo.startvehicletime),r=q(null===y||void 0===y?void 0:y.routeInfo.endvehicletime);null===z?e=[]:(e={},z.forEach((function(t){return e[t.nodeord]=t})));var a=M(null===y||void 0===y?void 0:y.routeInfo.routetp);return Object(O.jsxs)("div",{className:"route-container",children:[Object(O.jsxs)("div",{className:"bus-stop-contaienr",children:[Object(O.jsxs)("div",{className:"bus-stop-name",children:[Object(O.jsx)(B,{fill:a}),y.routeno]}),Object(O.jsxs)("div",{className:"route-info-container",children:[Object(O.jsxs)("div",{className:"route-info-item",children:[Object(O.jsx)("div",{className:"title",children:"\ub178\uc120\uc720\ud615"}),Object(O.jsx)("div",{className:"information",children:null===y||void 0===y?void 0:y.routeInfo.routetp})]}),Object(O.jsxs)("div",{className:"route-info-item",children:[Object(O.jsx)("div",{className:"title",children:"\uc6b4\ud589\uc2dc\uac04"}),Object(O.jsxs)("div",{className:"information",children:["\uccab\ucc28 ",c,", \ub9c9\ucc28 ",r]})]}),Object(O.jsxs)("div",{className:"route-info-item",children:[Object(O.jsx)("div",{className:"title",children:"\ubc30\ucc28\uac04\uaca9"}),Object(O.jsxs)("div",{className:"information",children:["\ud3c9\uc77c ",null===y||void 0===y?void 0:y.routeInfo.intervaltime,"\ubd84, \ud1a0\uc694\uc77c ",null===y||void 0===y?void 0:y.routeInfo.intervalsattime,"\ubd84, \uc77c\uc694\uc77c ",null===y||void 0===y?void 0:y.routeInfo.intervalsuntime,"\ubd84"]})]})]}),Object(O.jsx)("div",{className:"bus-stop-information",children:Object(O.jsxs)("div",{className:"refresh-time",children:[m," \uae30\uc900",Object(O.jsx)("button",{onClick:function(){return P(null===y||void 0===y?void 0:y.routeid)},children:Object(O.jsx)("i",{className:"fas fa-sync-alt"})})]})})]}),Object(O.jsx)("div",{className:"route-list",children:null!==y&&y.routeInfo.busStopList.map((function(t,n){return Object(O.jsxs)("div",{className:"route-item",children:[Object(O.jsx)("div",{className:"route-line",style:{borderColor:a},children:Object.keys(e).includes(t.nodeord.toString())?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{className:"bus-logo",style:{borderColor:a},children:Object(O.jsx)(B,{fill:a})}),Object(O.jsx)("div",{className:"bus-number",style:{color:a,borderColor:a},children:e[t.nodeord.toString()].vehicleno.slice(-7)})]}):Object(O.jsx)(O.Fragment,{})}),Object(O.jsxs)("div",{className:"bus-stop-text",children:[Object(O.jsxs)("div",{className:"node-name",children:[t.nodenm,y.routeInfo.startnodenm===t.nodenm&&Object(O.jsx)("div",{className:"start-end-label",children:"\uae30\uc810"}),y.routeInfo.endnodenm===t.nodenm&&Object(O.jsx)("div",{className:"start-end-label",children:"\uc885\uc810"})]}),Object(O.jsx)("div",{className:"node-number",children:t.nodeno})]})]},n)}))})]});default:return Object(O.jsx)(O.Fragment,{})}}()})},D=function(){return Object(O.jsx)("header",{className:"App-header",children:Object(O.jsx)("div",{className:"logo",children:"Bus Information"})})},z=function(){var e=Object(c.useState)(16),t=Object(r.a)(e,2),n=t[0],s=t[1],o=Object(c.useState)([36.37412735693837,127.36563659840922]),a=Object(r.a)(o,2),i=a[0],l=a[1],u=Object(c.useState)([]),d=Object(r.a)(u,2),j=d[0],b=d[1],m=Object(c.useState)(null),f=Object(r.a)(m,2),v=f[0],p=f[1],h=Object(c.useState)("-1"),x=Object(r.a)(h,2),g=x[0],S=x[1],y=Object(c.useState)(0),I=Object(r.a)(y,2),C=I[0],k=I[1],w=Object(c.useState)(!0),B=Object(r.a)(w,2),A=B[0],z=B[1],F=function(e,t,n,c,o){var r={citycode:e,gpslati:t,gpslong:n,nodeid:c,nodenm:o};l([t,n]),p(r),S(c),s(18),z(!1),k(1)};return Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)(D,{}),Object(O.jsxs)("div",{className:"contents",children:[Object(O.jsx)(N,{station:j,setStation:b,settingBusStop:F,position:i,setPosition:l,selectID:g,setSelectID:S,zoomLevel:n,setZoomLevel:s,apiState:A,setApiState:z}),Object(O.jsx)(L,{station:j,settingBusStop:F,setMapMode:k,mapMode:C,selectBusStop:v}),Object(O.jsx)("button",{className:"mode-change-button",onClick:function(){0!==C&&k(C-1)},children:Object(O.jsx)("i",{className:"fas fa-times"})})]})]})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,70)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),o(e),r(e)}))};o.a.render(Object(O.jsx)(z,{}),document.getElementById("root")),F()}},[[63,1,2]]]);
//# sourceMappingURL=main.22d77901.chunk.js.map